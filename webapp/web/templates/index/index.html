<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    {% block title %}
    PSU-TGO
    {% endblock %}
  </title>
  <link rel="stylesheet" href="{{ 'css/app.css' | static_url }}">
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="{{ 'node_modules/htmx.org/dist/htmx.min.js' | static_url }}"></script>
  <script src="{{ 'node_modules/cally/dist/cally.js' | static_url }}"></script>
  <script src="{{ 'js/date-picker.js' | static_url }}"></script>
  {% block head %}
  {% endblock head %}
</head>

<body class="bg-base-200">
  <div class="flex flex-col min-h-screen">

    <!-- Sidebar Toggle -->
    <input id="sidebar-toggle" type="checkbox" class="hidden peer" />

    <!-- Overlay -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black opacity-0 pointer-events-none z-10 transition-opacity duration-300"></div>

    <!-- Sidebar -->
    <div id="sidebar" class="sidebar fixed top-0 left-0 h-full bg-base-100 shadow-md z-20 flex flex-col transition-transform duration-300">
      <!-- Logo Section -->
      <div class="flex items-center gap-2 p-2">
        <a href="/" class="flex items-center gap-4">
          <div class="w-12 h-12 bg-primary rounded-lg flex items-center justify-center text-primary-content font-bold">
            <span class="text-xl font-bold">P</span>
          </div>
          <div>
            <h1 class="text-xl font-bold text-base-content">PSU-TGO</h1>
            <p class="text-sm text-base-content">PSU-TGO</p>
          </div>
        </a>
      </div>
      <div class="divider m-0"></div>

      <!-- Menu Section -->
      <ul class="menu flex-grow w-full p-2 bg-base-100 space-y-4">
        <li>
          <a href="/users-management" class="flex items-center gap-4 rounded-lg p-3 font-bold {% if request.path == '/users-management/' %}bg-primary text-primary-content{% else %}hover:bg-primary/90 hover:text-primary-content/90{% endif %}">
            <i data-feather="users"></i>
            <span class="text-md">User Management</span>
          </a>
        </li>
        <li>
          <a href="/role-management" class="flex items-center gap-4 rounded-lg p-3 font-bold {% if request.path == '/role-management/' %}bg-primary text-primary-content{% else %}hover:bg-primary/90 hover:text-primary-content/90{% endif %}">
            <i data-feather="shield"></i>
            <span class="text-md">Role Management</span>
          </a>
        </li>
        <li>
          <a href="/form-management" class="flex items-center gap-4 rounded-lg p-3 font-bold {% if request.path == '/form-management/' %}bg-primary text-primary-content{% else %}hover:bg-primary/90 hover:text-primary-content/90{% endif %}">
            <i data-feather="file-text"></i>
            <span class="text-md">Form Management</span>
          </a>
        </li>
        <li>
          <a href="/emissions-scope" class="flex items-center gap-4 rounded-lg p-3 font-bold {% if request.path == '/emissions-scope' %}bg-primary text-primary-content{% else %}hover:bg-primary/90 hover:text-primary-content/90{% endif %}">
            <i data-feather="bar-chart-2"></i>
            <span class="text-md">Emissions scope</span>
          </a>
        </li>
        <li>
          <a href="/settings" class="flex items-center gap-4 rounded-lg p-3 font-bold {% if request.path == '/settings' %}bg-primary text-primary-content{% else %}hover:bg-primary/90 hover:text-primary-content/90{% endif %}">
            <i data-feather="settings"></i>
            <span class="text-md">Settings</span>
          </a>
        </li>
      </ul>

      <div class="divider m-0"></div>

      <!-- Logout -->
      <div class="p-2">
        <a href="/users/logout" class="flex items-center gap-3 rounded-lg p-3 font-bold hover:bg-primary/90 hover:text-primary-content/90">
          <i data-feather="log-out"></i>
          <span class="text-lg">Log out</span>
        </a>
      </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar bg-base-100 p-3 shadow-md flex justify-between items-center transition-all duration-300" id="navbar">
      <!-- Sidebar Toggle Button -->
      <div class="flex-none">
        <label for="sidebar-toggle" class="btn btn-ghost btn-square">
          <i data-feather="menu" class="h-6 w-6"></i>
        </label>
      </div>
      <!-- Page Title -->
      <div class="flex-1 flex flex-col pl-4">
        <span class="text-lg font-bold text-base-content">
          {% if request.path == '/users/users-management' %}
            User Management
          {% elif request.path == '/users/roles-management' %}
            Role Management
          {% elif request.path == '/reports' %}
            Reports
          {% elif request.path == '/settings' %}
            Settings
          {% else %}
            PSU-TGO
          {% endif %}
        </span>
        <span class="text-sm">
          {% if request.path == '/users/users-management' %}
            Manage user accounts and permissions
          {% elif request.path == '/users/roles-management' %}
            Manage roles and permissions
          {% elif request.path == '/reports' %}
            View and analyze reports
          {% elif request.path == '/settings' %}
            Configure system settings
          {% else %}
            Welcome to PSU-TGO
          {% endif %}
        </span>
      </div>
      <!-- User Profile -->
      <div class="flex items-center gap-2">
        <a href="/profile/" class="flex items-center gap-2">
          <div class="w-10 h-10 bg-primary rounded-full flex items-center justify-center text-primary-content font-bold">
            <span class="text-lg font-bold">{{ current_user.username[0]|upper }}</span>
          </div>
          <span class="ml-2 text-base font-medium text-base-content">{{ current_user.username }}</span>
        </a>
      </div>
    </nav>

    <!-- Main Content -->
    <div id="main-content">
      <!-- Hero Video Section - อยู่ที่เดิม ไม่เลื่อน -->
      <section class="hero-video-section relative w-full h-screen overflow-hidden">
        <video autoplay muted loop playsinline class="absolute inset-0 w-full h-full object-cover z-0">
          <source src="/static/imagines/dashboard-image.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <div class="relative z-10 flex flex-col items-center justify-center h-full text-center text-white px-4">
          <h1 class="text-4xl font-bold animate-fade-up">Understand Your Impact on the Planet</h1>
          <p class="mt-4 text-lg animate-fade-up delay-100">ถ้าเปลี่ยนมาใช้ชีวิตอย่างใส่ใจ ยั่งยืนต่อสิ่งแวดล้อม เรื่องที่สอนคือ Basic Python</p>
          <div class="mt-6 space-x-4 animate-fade-up delay-200">
            <a href="#" class="bg-green-600 text-white px-6 py-2 rounded-full hover:bg-green-700">Calculate My Footprint ➜</a>
            <a href="#" class="border border-white text-white px-6 py-2 rounded-full hover:bg-white hover:text-green-600">Learn More</a>
          </div>
        </div>
      </section>

      <!-- Content Area - เลื่อนตาม sidebar -->
      <div class="content-area relative z-10 -mt-20 px-4 lg:px-0 pb-10">
        {% block body %}
        <div class="px-3 lg:px-5 py-10 mx-auto">
          {% block content %}
          <!-- เนื้อหาหน้าต่าง ๆ จะแสดงที่นี่ -->
          {% endblock content %}
        </div>
        {% endblock body %}
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div id="modal-content" class="modal-box w-full max-w-none bg-white">
      <!-- เนื้อหาจะถูกโหลดที่นี่ -->
    </div>
  </div>

  <style>
    /* Sidebar Transition - สมูธการขยายและหด */
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 16rem;
      height: 100%;
      transform: translateX(-100%);
      transition: transform 0.4s ease-in-out;
      z-index: 30;
    }
    
    #sidebar-toggle:checked ~ .sidebar {
      transform: translateX(0);
    }
    
    /* Navbar - หดขยายตาม sidebar */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 15;
      transition: margin-left 0.4s ease-in-out, width 0.4s ease-in-out;
    }
    
    #sidebar-toggle:checked ~ .navbar {
      margin-left: 16rem;
      width: calc(100% - 16rem);
    }
    
    /* Main Content */
    #main-content {
      margin-top: 5rem;
    }
    
    /* Hero Video Section - ไม่เลื่อนตาม sidebar */
    .hero-video-section {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 1;
    }
    
    /* Content Area - เลื่อนไปขวาเมื่อ sidebar เปิด */
    .content-area {
      position: relative;
      z-index: 10;
      transition: margin-left 0.4s ease-in-out;
    }
    
    #sidebar-toggle:checked ~ #main-content .content-area {
      margin-left: 16rem;
    }
    
    /* Overlay */
    #sidebar-overlay {
      z-index: 20;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }
    
    #sidebar-toggle:checked ~ #sidebar-overlay {
      opacity: 0.5;
      pointer-events: auto;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      #sidebar-toggle:checked ~ .navbar {
        margin-left: 0;
        width: 100%;
      }
      
      #sidebar-toggle:checked ~ #main-content .content-area {
        margin-left: 0;
      }
      
      #sidebar-toggle:checked ~ #sidebar-overlay {
        opacity: 0.5;
        pointer-events: auto;
      }
    }
    
    /* Animation Classes */
    .animate-fade-up {
      animation: fadeUp 1s ease-out forwards;
      opacity: 0;
      transform: translateY(30px);
    }
    
    .delay-100 {
      animation-delay: 0.1s;
    }
    
    .delay-200 {
      animation-delay: 0.2s;
    }
    
    @keyframes fadeUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    </style>

  <script>
    // Feather Replace Script
    feather.replace();

    document.addEventListener('DOMContentLoaded', function () {
      const sidebarToggle = document.getElementById('sidebar-toggle');
      const overlay = document.getElementById('sidebar-overlay');
      const navbar = document.getElementById('navbar');

      // ปิด sidebar เมื่อคลิก overlay
      overlay.addEventListener('click', function () {
        sidebarToggle.checked = false;
      });

      // Navbar scroll effect
      window.addEventListener('scroll', function () {
        if (window.scrollY > 50) {
          navbar.classList.remove('bg-transparent');
          navbar.classList.add('bg-white', 'shadow-md');
        } else {
          navbar.classList.remove('bg-white', 'shadow-md');
          navbar.classList.add('bg-transparent');
        } 
      });
    });
  </script>

  {% block js %}
  {% endblock js %}
</body>

</html>