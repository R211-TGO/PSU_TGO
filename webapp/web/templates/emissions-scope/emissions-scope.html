{% extends "/base/default_page.html" %}
{% block content %}

<!-- Mockup Data -->
{% set mockup_data = {
  "overall_progress": 30,
  "total_sources": 10,
  "in_progress": 6,
  "not_started": 4,
  "completed": 1,
  "scopes": {
    "Scope 1": [
      {"id": "1.1", "title": "การเดินทางภายในและภายนอกสถาบันด้วยยานพาหนะขององค์กร", "progress": 35, "status": "In progress"},
      {"id": "1.2", "title": "การรั่วไหลของก๊าซมีเทนจาก septic tank", "progress": 42, "status": "In progress"},
      {"id": "1.3", "title": "ก๊าซมีเทนจากระบบบำบัดน้ำเสียของมหาวิทยาลัย", "progress": 51, "status": "In progress"},
      {"id": "1.4", "title": "การเดินทางภายในและภายนอกสถาบันด้วยยานพาหนะขององค์กร", "progress": 75, "status": "In progress"},
      {"id": "1.5", "title": "การเดินทางภายในและภายนอกสถาบันด้วยยานพาหนะขององค์กร", "progress": 0, "status": "Not started"}
    ],
    "Scope 2": [
      {"id": "2.1", "title": "การใช้พลังงานไฟฟ้าภายในมหาวิทยาลัย", "progress": 60, "status": "In progress"},
      {"id": "2.2", "title": "การใช้พลังงานไฟฟ้าจากแหล่งพลังงานหมุนเวียน", "progress": 80, "status": "Completed"}
    ],
    "Scope 3": [
      {"id": "3.1", "title": "การเดินทางของบุคลากรและนักศึกษา", "progress": 20, "status": "Not started"},
      {"id": "3.2", "title": "การจัดการขยะและของเสีย", "progress": 45, "status": "In progress"}
    ]
  }
} %}

<div class="p-4">
  <!-- Header Section -->
  <div class="card shadow-lg p-6 bg-white rounded-lg">
    <h2 class="text-2xl font-bold mb-2">Sources of Greenhouse Gas Emissions and Removals</h2>
    <p class="text-sm text-gray-500">Prince of Songkla University (Campus Level)</p>
    <div class="mt-4 flex items-center gap-4">
      <progress class="progress progress-success w-1/3" value="{{ mockup_data.overall_progress }}" max="100"></progress>
      <div class="text-sm">
        <strong>Overall Progress:</strong> {{ mockup_data.overall_progress }}%
        <span class="ml-2 text-xs text-gray-500">
          Total Sources: {{ mockup_data.total_sources }} |
          In Progress: {{ mockup_data.in_progress }} |
          Not Started: {{ mockup_data.not_started }} |
          Completed: {{ mockup_data.completed }}
        </span>
      </div>
    </div>
  </div>

  <!-- Scopes Section -->
  {% for scope_name, scope_items in mockup_data.scopes.items() %}
  <div class="mt-12">
    <h3 class="text-xl font-semibold mb-6 flex items-center gap-4">
      <!-- วงกลมที่มีตัวเลข -->
      <span class="w-10 h-10 flex items-center justify-center bg-primary text-white rounded-full">
        {{ loop.index }}
      </span>
      {{ scope_name }}
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      {% for item in scope_items %}
      <div class="card-style p-5 rounded-lg shadow bg-gray-50 relative">
        <div class="flex justify-between items-center">
          <h4 class="font-semibold text-base flex items-center gap-2">
            <span class="w-8 h-8 flex items-center justify-center bg-blue-100 text-gray-800 rounded-full">
              {{ item.id }}
            </span>
            {{ item.title }}
          </h4>
          {% set badge_class = {
            'In progress': 'badge-info',
            'Not started': 'badge-neutral',
            'Completed': 'badge-success'
          }[item.status] %}
          <span class="badge {{ badge_class }}">{{ item.status }}</span>
        </div>
        <!-- Progress Circle and Edit Icon in the Same Row -->
        <div class="flex justify-between items-center mt-4">
          <!-- Progress Circle -->
          <div class="relative w-8 h-8">
            <svg class="w-full h-full transform -rotate-90">
              <circle cx="50%" cy="50%" r="40%" stroke="#e5e7eb" stroke-width="3" fill="none"></circle>
              <circle cx="50%" cy="50%" r="40%" stroke="#3b82f6" stroke-width="3" fill="none"
                stroke-dasharray="125.6"
                stroke-dashoffset="{{ 125.6 - (item.progress / 100) * 125.6 }}">
              </circle>
            </svg>
            <div class="absolute inset-0 flex items-center justify-center">
              <span class="text-xs font-bold text-gray-700">{{ item.progress }}%</span>
            </div>
          </div>
          <!-- Edit Icon -->
          <a href="/edit/{{ item.id }}" class="text-blue-500 hover:text-blue-700">
            <i data-feather="edit"></i>
          </a>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endfor %}
</div>
{% endblock content %}
